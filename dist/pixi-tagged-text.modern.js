import{Texture as t,BaseTexture as e}from"@pixi/core";import{Sprite as n}from"@pixi/sprite";import{TextMetrics as s,Text as i}from"@pixi/text";import{Container as r}from"@pixi/display";import{Graphics as o}from"@pixi/graphics";import"@pixi/events";import a from"emoji-regex";import{Rectangle as l}from"@pixi/math";function h(){return h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},h.apply(this,arguments)}const d=(t,e)=>h({},t,e),c=t=>t[t.length-1],u=t=>void 0!==t,p=(t,e)=>n=>[n].flat(255).reduce(t,e),g=t=>p((e,n)=>e&&t(n),!0),f="imgSrc",w="imgDisplay",x=()=>({content:"",bounds:new l,fontProperties:{ascent:0,descent:0,fontSize:0},style:{},tags:"",textDecorations:[]}),y=t=>""!==t&&t.split("").every(t=>0===t.search(/\s/)),m=g(t=>t.content instanceof n),b=t=>"string"==typeof t.content,S=g(b),v=g(t=>void 0!==t&&b(t)&&y(t.content)),_=t=>{return void 0!==t&&b(t)&&y(e=t.content)&&"\n"===e;var e},$=t=>void 0!==t&&g(_)(t),T=(C=v,t=>!C(t));var C;const N=t=>t instanceof Object&&0===Object.keys(t).length,F=(t=["\\w+"])=>{const e=t.join("|"),n=t=>`(${t})`,s=t=>`(?:${t})`,i=s("\"|'"),r=`[^${i}]`,o=n(e),a=r+"+",l=n(s("\\s+"+s("[A-Za-z0-9_\\-]+")+"="+i+s(a)+i)+"*")+"+";return new RegExp("<"+o+l+"\\s*>|"+`</${o}\\s*>`,"g")},k="__EMOJI__",E=(t="")=>""===t?{}:t.trim().split(/\s+/).reduce((t,e)=>{const n=e.split("="),s=n[0].trim(),i=n[1].substr(1,n[1].length-2).trim();return t[s]=i,t},{}),D=t=>{const{0:e,1:n,2:s,3:i,index:r}=t;return{tag:e,tagName:null!=n?n:i,isOpening:void 0!==n,attributes:E(s),index:r}},M=(()=>{const t=t=>`(${t})`,e=t=>t+"*";return new RegExp("<"+t("[A-Za-z_]"+e("[A-Za-z0-9_]"))+t(e(`[^${["/",">"].join("")}]`))+"/>","gs")})(),j=t=>h({tag:t.tagName,children:[]},N(t.attributes)?{}:{attributes:t.attributes}),O=t=>{const e=t.split(" ");let n="";for(let t=0;t<e.length;t++)n+=`${e[t].charAt(0).toUpperCase()}${e[t].substr(1)} `;return n.trim()},P=t=>s.measureFont(t.font),I=(t,e=!1)=>{if(e)return t.updateText(!1),P(t.context);{var n;const e=P(t.context),s=null!=(n=t.style.fontSize)?n:NaN;if(10===e.ascent&&2===e.descent&&(isNaN(Number(s))||s>12))throw new Error("getFontPropertiesOfText() returned metrics associated with a Text field that has not been updated yet. Please try using the forceUpdate parameter when you call this function.");return P(t.context)}},U={align:"left",valign:"baseline",[w]:"inline",wordWrap:!0,wordWrapWidth:500,lineSpacing:0,fill:0},z=d,W=t=>t.filter(u).reduce(z,{}),L=(t,e,n={})=>{var s;const i=null!=(s=((t={},e={})=>{if(!N(e)||!N(t))return d(e,(t=>{const e={};for(const n in t){const s=t[n];e[n]=!1===isNaN(parseFloat(s))?parseFloat(s):s}return e})(t))})(n,e[t]))?s:{};if(0!==Object.values(i).length)return i},A=(t,e={x:0,y:0})=>new l(e.x+t.x,e.y+t.y,t.width,t.height),H=t=>e=>e.map((t=>e=>h({},e,{x:e.x+t.x,y:e.y+t.y}))(t)),R=t=>{const e=t[0],n=c(t);return void 0===e?0:n===e?e.width:n.x+n.width-e.x},G=t=>e=>h({},e,{x:t}),V=t=>e=>{let n;return e.map(e=>(void 0===n?(e.bounds.x=t,n=e.bounds):(e.bounds.x=n.x+n.width,n=e.bounds),e))},B=(t={x:NaN,y:NaN,width:NaN,height:NaN},e={x:NaN,y:NaN,width:NaN,height:NaN})=>{if(isNaN(t.x))return e;const n=Math.min(t.x,e.x),s=Math.min(t.y,e.y);return{x:n,y:s,width:Math.max(t.x+t.width,e.x+e.width)-n,height:Math.max(t.y+t.height,e.y+e.height)-s}},Z=p((t,e)=>B(t,e.bounds),{x:NaN,y:NaN,width:NaN,height:NaN}),J=t=>t.reduce((t,e,n)=>0===n?[G(0)(e)]:t.concat([G(t[n-1].x+t[n-1].width)(e)]),[]),Y=t=>p((t,e)=>{var n,s;let i=null!=(n=e.bounds.height)?n:0;return m(e)&&(i+=e.fontProperties.descent),i>(null!=(s=null==t?void 0:t.bounds.height)?s:0)?e:t},x())(t),X=t=>""!==t,q="_ðŸ”ª_",K=t=>t.replace(/\s/g,`${q}$&${q}`).split(q).filter(t=>""!==t),Q={debug:!1,debugConsole:!1,splitStyle:"words",imgMap:{},skipUpdates:!1,skipDraw:!1,drawWhitespace:!1,wrapEmoji:!0},tt=16776960,et={fontFamily:"courier",fontSize:10,fill:16777215,dropShadow:!0},nt={default:U};Object.freeze(nt),Object.freeze(U);class st extends n{static get defaultStyles(){return nt}static get defaultOptions(){return Q}get options(){return this._options}get needsUpdate(){return this._needsUpdate}get needsDraw(){return this._needsDraw}get tokensFlat(){return this._tokens.flat(3)}get tokens(){return this._tokens}get text(){return this._text}set text(t){this.setText(t)}setText(t,e){t===this._text&&!1===this._needsUpdate||(this._text=t,this._needsUpdate=!0,this.updateIfShould(e))}get untaggedText(){return this.text.replace(F(),"")}get tagStyles(){return this._tagStyles}set tagStyles(t){this.setTagStyles(t)}setTagStyles(t,e){Object.entries(t).forEach(([t,e])=>this.setStyleForTag(t,e,!0)),this._needsUpdate=!0,this.updateIfShould(e)}getStyleForTag(t,e={}){return L(t,this.tagStyles,e)}getStyleForTags(t){const e=t.map(({tagName:t,attributes:e})=>this.getStyleForTag(t,e));return W(e)}setStyleForTag(t,e,n){return this.tagStyles[t]=e,"default"===t&&this.defaultStyle[f]&&(console.error(`Style "${f}" can not be set on the "default" style because it will add images to EVERY tag!`),this.defaultStyle[f]=void 0),this._needsUpdate=!0,this.updateIfShould(n),!0}removeStylesForTag(t,e){return t in this.tagStyles&&(delete this.tagStyles[t],this._needsUpdate=!0,this.updateIfShould(e),!0)}get defaultStyle(){var t;return null==(t=this.tagStyles)?void 0:t.default}set defaultStyle(t){this.setDefaultStyle(t)}setDefaultStyle(t,e){this.setStyleForTag("default",t,e)}get textFields(){return this._textFields}get sprites(){return this._sprites}get decorations(){return this._decorations}get spriteTemplates(){return this._spriteTemplates}get textContainer(){return this._textContainer}get decorationContainer(){return this._decorationContainer}get spriteContainer(){return this._spriteContainer}get debugContainer(){return this._debugContainer}constructor(t="",e={},n={},s){super(s),this._options=void 0,this._needsUpdate=!0,this._needsDraw=!0,this._tokens=[],this._text="",this._tagStyles={},this._textFields=[],this._sprites=[],this._decorations=[],this._spriteTemplates={},this._debugGraphics=null,this._textContainer=void 0,this._decorationContainer=void 0,this._spriteContainer=void 0,this._debugContainer=void 0,this._textContainer=new r,this._spriteContainer=new r,this._decorationContainer=new r,this._debugContainer=new r,this.addChild(this._textContainer),this.addChild(this._spriteContainer),this.addChild(this._decorationContainer),this.addChild(this._debugContainer),this.resetChildren();const i=h({},Q,n);this._options=i,e=h({default:{}},e),this.options.wrapEmoji&&(e[k]={fontFamily:"sans-serif"});const o=h({},U,e.default);e.default=o,this.tagStyles=e,this.options.imgMap&&this.createSpriteTemplatesFromSourceMap(this.options.imgMap),this.text=t}resetChildren(){this._debugContainer.removeChildren(),this._textContainer.removeChildren(),this._spriteContainer.removeChildren(),this._decorationContainer.removeChildren(),this._textFields=[],this._sprites=[],this._decorations=[]}createSpriteTemplatesFromSourceMap(s){this._spriteTemplates={},Object.entries(s).forEach(([s,i])=>{var r;let o;if(i instanceof n)o=i;else if("string"==typeof(a=i)||a instanceof t||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement)o=n.from(i);else{if(!(t=>t instanceof HTMLImageElement||t instanceof e)(i))throw new TypeError(`The spriteSource provided for key ${s} was not in a valid format. Please use a Sprite, Texture, BaseTexture, string, HTMLImageElement, HTMLVideoElement, HTMLCanvasElement, or SVGElement`);o=n.from(t.from(i))}var a;const l=o.texture;void 0!==l&&l.baseTexture.addListener("update",t=>this.onImageTextureUpdate(t)),this.spriteTemplates[s]=o;const d=null!=(r=this.getStyleForTag(s))?r:{},c=h({[f]:s},d);this.setStyleForTag(s,c)})}onImageTextureUpdate(t){this._needsUpdate=!0,this._needsDraw=!0,this.updateIfShould()}updateIfShould(t){return(!1===t||void 0===t&&!1===this.options.skipUpdates)&&(this.update(),!0)}update(t){const e=this.tagStyles,{splitStyle:s}=this.options,r=this.options.imgMap&&this.spriteTemplates,o=((t,e,s)=>{var i;const r=null!=(i=e.default)?i:{},o=[],a={},l=t=>{var i;if("string"==typeof t)return t;const{tag:d,attributes:c={}}=t;let u=r,p="";var g;d&&(o.push({tagName:d,attributes:c}),p=(g=o,g.map(t=>t.tagName)).join(","),u=((t,e,n)=>{const s=JSON.stringify(t);if(void 0===n[s]){const i=e.default,r=t.map(t=>(({tagName:t,attributes:e},n)=>L(t,n,e))(t,e)),o=[i,...r];n[s]=W(o)}return n[s]})(o,e,a),u=(t=>{const{textDecoration:e}=t;if(void 0===e||"normal"===e)return t;const{decorationColor:n,decorationThickness:s}=t,i=n||t.fill||U.fill,r=s||1;function o(e,n=e){var s,o,a,l;return null!=(s=t.textDecoration)&&s.includes(e)?{[`${n}Color`]:null!=(o=t[`${n}Color`])?o:i,[`${n}Thickness`]:null!=(a=t[`${n}Thickness`])?a:r,[`${n}Offset`]:null!=(l=t[`${n}Offset`])?l:0}:{}}return h({},t,o("underline"),o("overline"),o("line-through","lineThrough"))})(u));const w={style:u,tags:p,children:t.children.map(l)},x=null!=(i=u[f])?i:"";if(x){if(void 0===s)throw new Error(`An image tag with ${f}="${x}" was encountered, but no imgMap was provided. Please include a valid Sprite in the imgMap property in the options in your TaggedText constructor.`);const t=s[x];if(void 0===t)throw new Error(`An image tag with ${f}="${x}" was encountered, but there was no matching sprite in the sprite map. Please include a valid Sprite in the imgMap property in the options in your TaggedText constructor.`);if(t instanceof n==0)throw new Error(`The image reference you provided for "${x}" is not a Sprite. The imgMap can only accept PIXI.Sprite instances.`);const e=(t=>new n(t.texture))(t);w.children=[e,...w.children]}return o.pop(),w};return l(t)})(((t,e,n)=>{this.options.wrapEmoji&&(t=>a().test(t))(t)&&(t=(t=>{const e=new RegExp(`((<|</)[^>]*)?(${a().source})+`,"gums");return t.replaceAll(e,(t,e)=>(null==e?void 0:e.length)>0?t:`<${k}>${t}</${k}>`)})(t)),t=(t=>t.replace(M,(t,e,n="")=>{let s=`<${e}${n}></${e}>`;return s=s.replace(/\s+/g," "),s=s.replace(/\s>/g,">"),s}))(t);const s=F(e),i=[];let r;for(;r=s.exec(t);){const t=D(r);i.push(t)}const o=((t,e)=>{const n=[];let s,i=t,r=0;for(s of e)if(void 0!==i){const{tag:t,index:e}=s,o=e-r,a=o+t.length;r+=a;const l=i.substr(0,o);n.push(l),i=i.substr(a)}return n.push(i),n})(t,i);return{children:((t,e)=>{const n={children:[]};""!==t[0]&&n.children.push(t[0]);const s=[n];for(let n=0;n<e.length;n++){var i;const r=e[n],o=null!=(i=t[n+1])?i:"";if(r.isOpening){const t=j(r);""!==o&&t.children.push(o),c(s).children.push(t),s.push(t)}else{const t=s.pop();if(void 0===t||t.tag!==r.tagName)throw new Error(`Unexpected tag nesting. Found a closing tag "${r.tagName}" that doesn't match the previously open tag "${null==t?void 0:t.tag}"`);""!==o&&c(s).children.push(o)}}return s.length>1&&console.warn(`Found ${s.length-1} unclosed tags in\n${s.map(t=>t.tag).join("-")}`),n.children})(o,i)}})(this.text,Object.keys(this.tagStyles)),e,r),l=((t,e="words")=>{var s,r;const o=new i(""),a=t.style;let l;const d=(t,s)=>i=>{let r=[];if(o.style=h({},t,{wordWrap:!1,dropShadowBlur:0,dropShadowDistance:0,dropShadowAngle:0,dropShadow:!1}),"string"==typeof i){const n=((t,e)=>{if("words"===e)return[t].flatMap(K).filter(X);if("characters"===e)return t.split("");{let t=' Supported styles are "words" and "characters"';const n=e.toLowerCase();throw 0===n.indexOf("char")?t='Did you mean "characters"?':0===n.indexOf("wor")&&(t='Did you mean "words"?'),new Error(`Unsupported split style "${e}". ${t}`)}})(i,e),a=n.map(e=>{var n,i,r;switch(t.textTransform){case"uppercase":o.text=e.toUpperCase();break;case"lowercase":o.text=e.toLowerCase();break;case"capitalize":o.text=O(e);break;default:o.text=e}const a=null!=(n=t.fontScaleWidth)?n:1,d=null!=(i=t.fontScaleHeight)?i:1,c=isNaN(a)||a<0?0:a,u=isNaN(d)||d<0?0:d;o.scale.set(c,u),l=h({},I(o,!0)),l.ascent*=u,l.descent*=u,l.fontSize*=u;const p=A(o),g=null!=(r=o.style.strokeThickness)?r:0;g>0&&(l.descent+=g/2,l.ascent+=g/2,l.fontSize=l.ascent+l.descent);const f=((t,e,n)=>{const{ascent:s,descent:i}=n,r=s,o=i,a=r-o,{width:l}=e;return["underline","overline","lineThrough"].map(function(e){var n;const s=t[`${e}Color`],h=t[`${e}Thickness`],d=null!=(n=t[`${e}Offset`])?n:0;if(void 0===s||void 0===h)return;let c=d;return"underline"===e?c+=r+i/2:"lineThrough"===e&&(c+=o+a/2),{color:s,bounds:{x:0,y:c,width:l,height:h}}}).filter(t=>void 0!==t)})(t,p,l);return{content:e,style:t,tags:s,bounds:p,fontProperties:l,textDecorations:f}});r=r.concat(a)}else if(i instanceof n){const e=i,n="icon"===t[w];if(l=h({},I(o,!0)),n){const t=Math.max(e.height,1);t>1&&1===e.scale.y&&e.scale.set(l.ascent/t*.8)}const a=A(e);r.push({content:e,style:t,tags:s,bounds:a,fontProperties:l,textDecorations:void 0})}else{const t=i,{children:e}=t,n=t.style,s=t.tags;if(void 0===n)throw new Error(`Expected to find a 'style' property on ${t}`);r=r.concat(e.flatMap(d(n,s)))}return r},c=t.children.flatMap(d(a,"")),{wordWrap:u,wordWrapWidth:p}=a,g=void 0!==p&&!isNaN(p)&&p>0,f=null!=(s=a.lineSpacing)?s:0,y=null!=(r=a.align)?r:"left";return((t,e,n,s)=>{const i={x:0,y:0};let r=0,o=[],a=[];const l=[];let d,c=0;function u(){void 0!==o&&o.length>0&&a.push(o),o=[],r=0}function p(){l.push(a),a=[]}function g(t){p(),i.x=0,i.y=i.y+c,c=0,f(t)}function f(t){var e,s,i,r;const o=null!=(e=null==t||null==(s=t.fontProperties)?void 0:s.fontSize)?e:0,a=null!=(i=null==t||null==(r=t.bounds)?void 0:r.height)?i:0;c=Math.max(c,o,n),!1===$(t)&&(c=Math.max(c,a))}function y(t){f(t),t.bounds.x=i.x,t.bounds.y=i.y,i.x+=t.bounds.width}function b(){o.forEach(y)}function S(t){return"block"===t.style[w]}function _(t){o.push(t),r+=t.bounds.width}for(let n=0;n<t.length;n++){d=t[n];const s=v(d),o=$(d),l=m(d);(s||l)&&(b(),u()),_(d),f(d),s&&(b(),u()),(o||S(d)||i.x+r>e&&a.length>0)&&g(d)}o.length>0&&(b(),u()),a.length>0&&p();const C=(t=>{for(const e of t){let t=e.length;for(;t>=0;){t-=1;const n=e[t];if(T(n))break;for(const t of n)t.bounds.width=0,t.bounds.height=Math.min(t.bounds.height,t.fontProperties.fontSize)}}return t})(l),N=((t,e,n)=>{let s=x(),i=0;const r=[];for(const n of t){var o,a,l,d;const t=[];let c=Y(n),u=null!=(o=null==(a=c.bounds)?void 0:a.height)?o:0,p=null!=(l=null==(d=c.fontProperties)?void 0:d.ascent)?l:0;m(c)&&(u+=c.fontProperties.descent,p=c.bounds.height),0===u?c=s:s=c;for(const e of n){const n=[];for(const t of e){if($(t)){const e=h({},t);n.push(e);continue}const{bounds:e,fontProperties:s,style:r}=t,o=e.height,a=h({},e),l=r.valign;let{ascent:d}=s;m(t)&&(d=t.bounds.height);let c=0;switch(l){case"bottom":c=i+u-o;break;case"middle":c=i+(u-o)/2;break;case"top":c=i;break;default:c=i+p-d}a.y=c;const g=h({},t,{bounds:a});n.push(g)}t.push(n)}i+=u+e,r.push(t)}return r})(((t,e,n)=>{let s;switch(t){case"left":s=J;break;case"right":s=(t=>e=>H({x:t-R(e),y:0})(J(e)))(e);break;case"center":s=(t=>e=>{return H({x:(n=R(e),s=t,(s-n)/2),y:0})(J(e));var n,s})(e);break;case"justify":i=e,s=t=>{if(0===t.length)return[];const e=t.filter(({width:t})=>t>0),n=e.length;if(1===n){const[e,...n]=t;return e.x=0,[e,...n]}const s=[],r=e.reduce(B),o=(i-r.width)/(n-1);let a;for(let e=0;e<t.length;e++){const n=t[e];if(0===n.width){s[e]=h({},n);continue}let i;if(i=void 0===a?0:a.x+a.width+o,isNaN(i))throw new Error("Something went wrong with the justified layout calculation. x is NaN.");const r=G(i)(n);a=r,s[e]=r}return s};break;default:throw new Error(`Unsupported alignment type ${t}! Use one of : "left", "right", "center", "justify"`)}var i;for(const t of n){const e=[];for(const n of t){const t=Z(n);if(e.push(t),isNaN(t.x))throw new Error("wordBounds not correct")}const n=s(e);for(let e=0;e<t.length;e++){const s=t[e];t[e]=V(n[e].x)(s)}}return n})(s,e,C),n);return N})(c,u&&g?p:Number.POSITIVE_INFINITY,f,y)})(o,s);return this._tokens=l,this._needsDraw=!0,this.drawIfShould(t),this.options.debugConsole&&console.log(this.toDebugString()),this._needsUpdate=!1,l}drawIfShould(t){return(!1===t||void 0===t&&!1===this.options.skipDraw)&&(this.draw(),!0)}draw(){this.resetChildren();const{drawWhitespace:t}=this.options,e=t?this.tokensFlat:this.tokensFlat.filter(T);let n,s=!1;e.forEach(t=>{if(S(t)&&(n=this.createTextFieldForToken(t),this.textContainer.addChild(n),this.textFields.push(n),t.textDecorations&&t.textDecorations.length>0)){for(const e of t.textDecorations){const t=this.createDrawingForTextDecoration(e);n.addChild(t),this._decorations.push(t)}s=!0}m(t)&&(n=t.content,this.sprites.push(n),this.spriteContainer.addChild(n));const{bounds:e}=t;n.x=e.x,n.y=e.y}),!1===t&&s&&console.warn("Warning: you may want to set the `drawWhitespace` option to `true` when using textDecoration (e.g. underlines) otherwise, spaces will not have text decorations."),this.options.debug&&this.drawDebug(),this._needsDraw=!1}createDrawingForTextDecoration(t){const{bounds:e}=t;let{color:n}=t;const s=new o;if("string"==typeof n){if(0!==n.indexOf("#"))throw new Error("Sorry, at this point, only hex colors are supported for textDecorations like underlines. Please use either a hex number like 0x66FF33 or a string like '#66FF33'");n="0x"+n.substring(1),n=parseInt(n,16)}return s.beginFill(n).drawRect(e.x,e.y,e.width,e.height).endFill(),s}createTextFieldForToken(t){const{textTransform:e=""}=t.style;let n=t.content;switch(e.toLowerCase()){case"lowercase":n=n.toLowerCase();break;case"uppercase":n=n.toUpperCase();break;case"capitalize":n=O(n)}const s=new i(n,t.style);let{fontScaleWidth:r=1,fontScaleHeight:o=1}=t.style;r=isNaN(r)||r<0?0:r,o=isNaN(o)||o<0?0:o;let a=r,l=o;const h=Math.max(r,o);if(h>1){var d;h===o?(a/=h,l=1):(l/=h,a=1);const t=null!=(d=s.style.fontSize)?d:0,e=("string"==typeof t?(t=>{const[e,n]=t.split(/(%|pt|px|r?em)/),s=parseFloat(e);switch(n){case"%":return.16*s;case"em":case"rem":return 16*s;case"pt":return 1.3281472327365*s;default:return s}})(t):t)*h;s.style.fontSize=e}return s.scale.set(a,l),s}toDebugString(){const t=this.tokens;let e=this.untaggedText+"\n=====\n";const n="\n    ";return void 0!==t&&(e+=t.map((t,e)=>t.map((t,s)=>t.map((t,i)=>{let r="";S(t)?r=$(t)?"\\n":`"${t.content}"`:m(t)&&(r="[Image]");let o=`\n${r}: (${e}/${s}/${i})`;return o+=`${n}tags: ${0===t.tags.length?"<none>":t.tags.split(",").map(t=>`<${t}>`).join(", ")}`,o+=`${n}style: ${Object.entries(t.style).map(t=>t.join(":")).join("; ")}`,o+=`${n}size: x:${t.bounds.x} y:${t.bounds.y} width:${t.bounds.width} height:${t.bounds.height} bottom:${t.bounds.height+t.bounds.y} right:${t.bounds.x+t.bounds.width}`,o+=`${n}font: fontSize:${t.fontProperties.fontSize} ascent:${t.fontProperties.ascent} descent:${t.fontProperties.descent}`,o}).join("\n")))),e}drawDebug(){const t=this.tokens;this._debugGraphics=new o,this.debugContainer.addChild(this._debugGraphics);const e=this._debugGraphics;function n(t,e){const n=new i(t,et);return n.x=e.x+1,n.y=e.y+1,n}e.clear();for(let i=0;i<t.length;i++){const r=t[i],o=Z(r);if(this.defaultStyle.wordWrap){var s;const t=null!=(s=this.defaultStyle.wordWrapWidth)?s:this.width;e.endFill().lineStyle(.5,tt,.2).drawRect(0,o.y,t,o.height).endFill()}for(let t=0;t<r.length;t++){const s=r[t];for(const t of s){const s=m(t),{x:i,y:r,width:o}=t.bounds,a=r+(s?t.bounds.height:t.fontProperties.ascent);let l,{height:h}=t.bounds;s&&(h+=t.fontProperties.descent),v(t)&&!1===this.options.drawWhitespace?e.lineStyle(1,11184810,1).beginFill(13421772,.2):e.lineStyle(1,16764108,1).beginFill(15658734,.2),$(t)?this.debugContainer.addChild(n("â†©ï¸Ž",{x:i,y:r+10})):e.lineStyle(.5,tt,.2).drawRect(i,r,o,h).endFill().lineStyle(1,16777113,1).beginFill().drawRect(i,a,o,1).endFill(),S(t)&&(l=`${t.tags}`,this.debugContainer.addChild(n(l,{x:i,y:r})))}}}}}export{st as default};
//# sourceMappingURL=pixi-tagged-text.modern.js.map
